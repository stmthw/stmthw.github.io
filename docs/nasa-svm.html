<!DOCTYPE html>
<html lang xml:lang>
<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 2 NASA SVM [ML|PY] | Data Portfolio</title>
  <meta name="description" content="&lt;p&gt;My online portfolio using a minimalist theme.&lt;/p&gt;">
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 2 NASA SVM [ML|PY] | Data Portfolio">
  <meta property="og:type" content="book">
  
  <meta property="og:description" content="&lt;p&gt;My online portfolio using a minimalist theme.&lt;/p&gt;">
  

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Chapter 2 NASA SVM [ML|PY] | Data Portfolio">
  
  <meta name="twitter:description" content="&lt;p&gt;My online portfolio using a minimalist theme.&lt;/p&gt;">
  

<meta name="author" content="Matthew Robert Sears">


<meta name="date" content="2022-09-30">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="google-capstone.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet">
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet">
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet">
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet">
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet">
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet">
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet">








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet">
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet">
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" data-external="1"></head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Portfolio</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> README</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#structure"><i class="fa fa-check"></i><b>1.1</b> Structure</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#why-bookdown"><i class="fa fa-check"></i><b>1.2</b> Why Bookdown?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="nasa-svm.html"><a href="nasa-svm.html"><i class="fa fa-check"></i><b>2</b> NASA SVM [ML|PY]</a>
<ul>
<li class="chapter" data-level="2.1" data-path="nasa-svm.html"><a href="nasa-svm.html#description"><i class="fa fa-check"></i><b>2.1</b> Description</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="nasa-svm.html"><a href="nasa-svm.html#data"><i class="fa fa-check"></i><b>2.1.1</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="nasa-svm.html"><a href="nasa-svm.html#algorithm"><i class="fa fa-check"></i><b>2.2</b> Algorithm</a></li>
<li class="chapter" data-level="2.3" data-path="nasa-svm.html"><a href="nasa-svm.html#analysis"><i class="fa fa-check"></i><b>2.3</b> Analysis</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="nasa-svm.html"><a href="nasa-svm.html#scripts"><i class="fa fa-check"></i><b>2.3.1</b> Scripts</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="nasa-svm.html"><a href="nasa-svm.html#conclusions"><i class="fa fa-check"></i><b>2.4</b> Conclusions</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="nasa-svm.html"><a href="nasa-svm.html#todo"><i class="fa fa-check"></i><b>2.4.1</b> TODO?</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="nasa-svm.html"><a href="nasa-svm.html#nasa-fw"><i class="fa fa-check"></i><b>2.5</b> Future Work?</a></li>
<li class="chapter" data-level="" data-path="nasa-svm.html"><a href="nasa-svm.html#source-code"><i class="fa fa-check"></i>Source Code</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="google-capstone.html"><a href="google-capstone.html"><i class="fa fa-check"></i><b>3</b> Google Capstone [DA|R]</a>
<ul>
<li class="chapter" data-level="3.1" data-path="google-capstone.html"><a href="google-capstone.html#description-1"><i class="fa fa-check"></i><b>3.1</b> Description</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="google-capstone.html"><a href="google-capstone.html#scenario"><i class="fa fa-check"></i><b>3.1.1</b> Scenario</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="google-capstone.html"><a href="google-capstone.html#ask"><i class="fa fa-check"></i><b>3.2</b> Ask</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="google-capstone.html"><a href="google-capstone.html#objective"><i class="fa fa-check"></i><b>3.2.1</b> Objective</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="google-capstone.html"><a href="google-capstone.html#prepare-process"><i class="fa fa-check"></i><b>3.3</b> Prepare / Process</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="google-capstone.html"><a href="google-capstone.html#pre-processing-with-r"><i class="fa fa-check"></i><b>3.3.1</b> Pre-Processing with R</a></li>
<li class="chapter" data-level="3.3.2" data-path="google-capstone.html"><a href="google-capstone.html#feature-engineering"><i class="fa fa-check"></i><b>3.3.2</b> Feature Engineering</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="google-capstone.html"><a href="google-capstone.html#analyze"><i class="fa fa-check"></i><b>3.4</b> Analyze</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="google-capstone.html"><a href="google-capstone.html#basic-descriptive-statistics"><i class="fa fa-check"></i><b>3.4.1</b> Basic Descriptive Statistics</a></li>
<li class="chapter" data-level="3.4.2" data-path="google-capstone.html"><a href="google-capstone.html#viz-trip-behavior"><i class="fa fa-check"></i><b>3.4.2</b> Viz: Trip Behavior</a></li>
<li class="chapter" data-level="3.4.3" data-path="google-capstone.html"><a href="google-capstone.html#viz-bike-choice"><i class="fa fa-check"></i><b>3.4.3</b> Viz: Bike Choice</a></li>
<li class="chapter" data-level="3.4.4" data-path="google-capstone.html"><a href="google-capstone.html#viz-popular-routes"><i class="fa fa-check"></i><b>3.4.4</b> Viz: Popular Routes</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="google-capstone.html"><a href="google-capstone.html#report"><i class="fa fa-check"></i><b>3.5</b> Share &amp; Act (Final Report)</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="google-capstone.html"><a href="google-capstone.html#key-observations"><i class="fa fa-check"></i><b>3.5.1</b> Key Observations</a></li>
<li class="chapter" data-level="3.5.2" data-path="google-capstone.html"><a href="google-capstone.html#actionables"><i class="fa fa-check"></i><b>3.5.2</b> Actionables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="rsql.html"><a href="rsql.html"><i class="fa fa-check"></i><b>4</b> Visualizing Sentiment [DA|R]</a>
<ul>
<li class="chapter" data-level="4.1" data-path="rsql.html"><a href="rsql.html#description-2"><i class="fa fa-check"></i><b>4.1</b> Description</a></li>
<li class="chapter" data-level="4.2" data-path="rsql.html"><a href="rsql.html#setup"><i class="fa fa-check"></i><b>4.2</b> Setup</a></li>
<li class="chapter" data-level="4.3" data-path="rsql.html"><a href="rsql.html#create-sql-database"><i class="fa fa-check"></i><b>4.3</b> Create SQL Database</a>
<ul>
<li class="chapter" data-level="" data-path="rsql.html"><a href="rsql.html#aside"><i class="fa fa-check"></i>Aside</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="rsql.html"><a href="rsql.html#write-query-table"><i class="fa fa-check"></i><b>4.4</b> Write &amp; Query Table</a></li>
<li class="chapter" data-level="4.5" data-path="rsql.html"><a href="rsql.html#analysis-1"><i class="fa fa-check"></i><b>4.5</b> Analysis</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="rsql.html"><a href="rsql.html#sentiment-word-clouds"><i class="fa fa-check"></i><b>4.5.1</b> Sentiment Word Clouds</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="rsql.html"><a href="rsql.html#alter-update-table"><i class="fa fa-check"></i><b>4.6</b> Alter &amp; Update Table</a></li>
<li class="chapter" data-level="4.7" data-path="rsql.html"><a href="rsql.html#r-sql"><i class="fa fa-check"></i><b>4.7</b> R &amp; SQL</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="nn-xor.html"><a href="nn-xor.html"><i class="fa fa-check"></i><b>5</b> NN: XOR [ML|PY,MATH]</a>
<ul>
<li class="chapter" data-level="5.1" data-path="nn-xor.html"><a href="nn-xor.html#backpropagation-and-xor"><i class="fa fa-check"></i><b>5.1</b> Backpropagation and XOR</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="nn-xor.html"><a href="nn-xor.html#motivation"><i class="fa fa-check"></i><b>5.1.1</b> Motivation</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="nn-xor.html"><a href="nn-xor.html#activation"><i class="fa fa-check"></i><b>5.2</b> Activation</a></li>
<li class="chapter" data-level="5.3" data-path="nn-xor.html"><a href="nn-xor.html#multivariable-calculus"><i class="fa fa-check"></i><b>5.3</b> Multivariable Calculus</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="nn-xor.html"><a href="nn-xor.html#dissecting-the-network"><i class="fa fa-check"></i><b>5.3.1</b> Dissecting the Network</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="nn-xor.html"><a href="nn-xor.html#conclusion"><i class="fa fa-check"></i><b>5.4</b> Conclusion</a></li>
<li class="chapter" data-level="5.5" data-path="nn-xor.html"><a href="nn-xor.html#learning-xor-in-tensorflow"><i class="fa fa-check"></i><b>5.5</b> Learning XOR in TensorFlow</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="nn-mnist.html"><a href="nn-mnist.html"><i class="fa fa-check"></i><b>6</b> NN: MNIST [ML|R,MATH]</a>
<ul>
<li class="chapter" data-level="6.1" data-path="nn-mnist.html"><a href="nn-mnist.html#setup-importing-data"><i class="fa fa-check"></i><b>6.1</b> Setup &amp; Importing Data</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="nn-mnist.html"><a href="nn-mnist.html#data-1"><i class="fa fa-check"></i><b>6.1.1</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="nn-mnist.html"><a href="nn-mnist.html#algorithm-1"><i class="fa fa-check"></i><b>6.2</b> Algorithm</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="nn-mnist.html"><a href="nn-mnist.html#initialize"><i class="fa fa-check"></i><b>6.2.1</b> Initialize</a></li>
<li class="chapter" data-level="6.2.2" data-path="nn-mnist.html"><a href="nn-mnist.html#learn"><i class="fa fa-check"></i><b>6.2.2</b> Learn</a></li>
<li class="chapter" data-level="" data-path="nn-mnist.html"><a href="nn-mnist.html#aside-2"><i class="fa fa-check"></i>Aside</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Portfolio</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="nasa-svm" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> NASA SVM [ML|PY]<a href="nasa-svm.html#nasa-svm" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><strong>Acronym disambiguation with machine learning</strong></p>
<p>A personal project using python and a <a href="https://data.nasa.gov/Raw-Data/NASA-Acronyms-in-Public-Abstracts/byqb-7uyn">public NASA dataset</a> related to acronyms in public NASA white paper abstracts.</p>
<p>My source of motivation comes from the suggestion in the dataset description:</p>
<blockquote>
<p>This was found to be a suitable dataset for training disambiguation models that use the context of the surrounding sentences to predict the correct meaning of the acronym. The prototype machine-learning models created from this dataset have not been released.</p>
</blockquote>
<p>So I decided to make my own prototype model and was inspired by an acronym disambiguation white paper from Courant Institute, NYU <span class="citation">(<a href="#ref-Turtel2007AcronymD" role="doc-biblioref">Turtel and Shasha 2007</a>)</span>.</p>
<div id="description" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Description<a href="nasa-svm.html#description" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Goal:</strong> Use an SVM and statistical analysis (of words/context) to properly classify ambiguous acronym definitions based on provided data.</p>
<ul>
<li>Acronym disambiguation is the process of determining the correct expansion/definition of an acronym in a given context
<ul>
<li>These specific acronyms have multiple definitions, making them ambiguous when undefined</li>
</ul></li>
<li>Ambiguous sentences contain undefined acronyms, whereas unambiguous sentences contain both the acronyms and their expansions</li>
</ul>
<p><strong>Example:</strong></p>
<p>In the given NASA abstracts, the acronym IMF is used with two separate definitions:</p>
<ol style="list-style-type: decimal">
<li>Interplanetary Magnetic Field (32 instances)</li>
<li>Intrinsic Mode Functions (14 instances)</li>
</ol>
<p>Given an ambiguous sentence containing an ambiguous acronym:</p>
<blockquote>
<p>Expressed in the IMFs, they have well-behaved Hilbert Transforms from which instantaneous frequencies can be calculated.</p>
</blockquote>
<p>The algorithm guesses what IMF stands for (in this case, intrinsic mode functions). It makes two guesses, one based on ambiguous context and another based on unambiguous context.</p>
<div id="data" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Data<a href="nasa-svm.html#data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Each line in <code>processed_acronyms.jsonl</code> is an acronym found to have more than one definition; there are 484.</p>
<p>However, according to the dataset&#x2019;s description, this isn&#x2019;t quality data &#x2013; insofar as what is defined as a &#x201C;proper&#x201D; alternate definition/expansion (see <a href="nasa-svm.html#nasa-fw">Future Work</a> section), along with a couple of wonky results too (see below).</p>
<p>For example, &#x201C;TOMS&#x201D; isn&#x2019;t really an ambiguous acronym:</p>
<ol style="list-style-type: decimal">
<li>Total Ozone Mapping Spectrometer</li>
<li>Ozone Mapping Spectrometer (</li>
</ol>
<p>This algorithm works for any legitimate ambiguous acronym within the dataset.</p>
<p>Example usage:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="nasa-svm.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env bash</span></span>
<span id="cb1-2"><a href="nasa-svm.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">python3</span> nasa_svm.py <span class="op">&lt;</span>nasa-acronym<span class="op">&gt;</span></span></code></pre></div>
<p>I could&#x2019;ve tailored the algorithm to sift through &#x2013; then run on &#x2013; every legitimate acronym, but for brevity&#x2019;s sake I selected 10 acronyms with 2 definitions, 5 acronyms with 3 definitions, and 1 acronym with 4 definitions (roughly paralleling the distribution):</p>
<p><strong>Acronyms</strong></p>
<p><code>1. &quot;US&quot;: &apos;United States&apos;, &apos;Upper Stage&apos;</code></p>
<p><code>2. &quot;SST&quot;: &apos;Sea Surface Temperature&apos;, &apos;Shear Stress Transport&apos;</code></p>
<p><code>3. &quot;IMF&quot;: &apos;Interplanetary Magnetic Field&apos;, &apos;Intrinsic Mode Functions&apos;</code></p>
<p><code>4. &quot;VMS&quot;: &apos;Vertical Motion Simulator&apos;, &apos;Visual Motion Simulator&apos;</code></p>
<p><code>5. &quot;RMS&quot;: &apos;Remote Manipulator System&apos;, &apos;Root Mean Square&apos;</code></p>
<p><code>6. &quot;DOE&quot;: &apos;Department of Energy&apos;, &apos;Design of Experiments&apos;</code></p>
<p><code>7. &quot;NAS&quot;: &apos;National Airspace System&apos;, &apos;Numerical Aerodynamic Simulation&apos;</code></p>
<p><code>8. &quot;LET&quot;: &apos;Linear Energy Transfer&apos;, &apos;Link Evaluation Terminal&apos;</code></p>
<p><code>9. &quot;MLS&quot;: &apos;Microwave Limb Sounder&apos;, &apos;Microwave Landing System&apos;</code></p>
<p><code>10. &quot;RCS&quot;: &apos;Reaction Control System&apos;, &apos;Radar Cross Section&apos;</code></p>
<p><code>11. &quot;ISO&quot;: &apos;Infrared Space Observatory&apos;, &apos;International Standards Organization&apos;, &apos;Imaging Spectrometric Observatory&apos;</code></p>
<p><code>12. &quot;CM&quot;: &apos;Crew Module&apos;, &apos;Command Module&apos;, &apos;Configuration Management&apos;</code></p>
<p><code>13. &quot;PEM&quot;: &apos;Pressurized Excursion Module&apos;, &apos;Proton Exchange Membrane&apos;, &apos;Pacific Exploratory Mission&apos;</code></p>
<p><code>14. &quot;CRM&quot;: &apos;Common Research Model&apos;, &apos;Cockpit Resource Management&apos;, &apos;Crew Resource Management&apos;</code></p>
<p><code>15. &quot;LCC&quot;: &apos;Launch Control Center&apos;, &apos;Launch Commit Criteria&apos;, &apos;Life Cycle Cost&apos;</code></p>
<p><code>16. &quot;ATM&quot;: &apos;Air Traffic Management&apos;, &apos;Asynchronous Transfer Mode&apos;, &apos;Apollo Telescope Mount&apos;, &apos;Airborne Topographic Mapper&apos;</code></p>
</div>
</div>
<div id="algorithm" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Algorithm<a href="nasa-svm.html#algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Skeleton:</strong></p>
<pre><code>INPUT: Acronym from NASA abstract

Filter all relevant abstracts
FOR each acronym definition:
    Find and extract all sentences containing acronym
    Separate into ambiguous and unambiguous
    Remove both the definitions and acronyms
END
Randomly sample test sentences containing ambiguous acronym
    Extract and remove these from training set
Build feature vector of surrounding meaningful words for context
    Concat sentences for each definition as the n documents for tf-idf
Train multi-class linear SVMs to yield word frequency coefficients
    Ambiguous and unambiguous contexts
FOR each test sentence:
    Create feature vector and feed into model for prediction
    Grade predictions
END

OUTPUT: results in csv format for analysis</code></pre>
<p><strong>CSV Output:</strong></p>
<p>The acronym is printed along with the accuracies for the ambiguous, unambiguous, and total contexts.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="nasa-svm.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python3</span> nasa_svm.py DOE</span></code></pre></div>
<pre><code>## DOE 0.9830508474576272 0.9661016949152542 1.0</code></pre>
<p><strong>Verbose Output:</strong></p>
<p>Provides more data, such as the amount of training examples for each definition.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="nasa-svm.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="bu">time</span> python3 nasa_svm.py ISO <span class="at">--v</span></span></code></pre></div>
<pre><code>## -------------------------
## Expansions:
## 
## Infrared Space Observatory
## International Standards Organization
## Imaging Spectrometric Observatory
## 
## Ambiguous n: 120     slices: [92, 15, 14] 
## Unambiguous n: 105   slices: [80, 14, 12] 
## Combined n: 712  slices: [543, 99, 71]
## 
## Test set: ( n = 30 )
## Infrared Space Observatory : 24
## International Standards Organization : 2
## Imaging Spectrometric Observatory : 4
## 
## Accuracy (ambiguous):  0.7333333333333333
## Accuracy (unambiguous):  0.7
## Accuracy (combined):  0.7333333333333333
## 
## real 0m3.771s
## user 0m3.397s
## sys  0m0.971s</code></pre>
<p>A bag of words model is implemented for the test samples, one for the vocabulary from the ambiguous context, and another for the vocabulary from the unambiguous context.</p>
<ul>
<li>This allows for proper feature vectors to be created for prediction</li>
</ul>
<p>The SVM uses an OVO (one-vs-one) shape for the decision function (<a href="https://stackoverflow.com/questions/59497115/svc-multiclass-classification-ovo-decision-function-explanation">see under the hood</a>), which in the case of binary classification always considers the distance from the hyperplane.</p>
<ul>
<li>I.e., how &#x201C;deep&#x201D; the data point is in a specific class&#x2019; area</li>
</ul>
<p>This also contributes to why the algorithm works so well for 2 definitions but poorly for 3-4 (see <a href="nasa-svm.html#conclusions">Conclusions</a>)</p>
</div>
<div id="analysis" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Analysis<a href="nasa-svm.html#analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Given the slices in verbose output, the first definition of every acronym seems to be dominant in terms of the frequency of instances.</p>
<p>I tried to account for this by making sure at least 2 samples from each definition are included since the test sentences are randomly sampled.</p>
<p>This, along with the sample sizes for the training sets being pretty small, causes the model trouble when classifying acronyms with more than 2 definitions.</p>
<p>I also added <em>all</em> the sentences for each acronym as a combined context to see if stripping &#x201C;noise&#x201D; actually helped the model.</p>
<p>My guess is that since the training set is small, every bit of text helps.</p>
<ul>
<li>Collecting only the surrounding words in sentences containing acronyms (as opposed to using the whole abstract for example) should work best with a large training set</li>
</ul>
<div id="scripts" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Scripts<a href="nasa-svm.html#scripts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For example, running the script 5 times and writing to csv files:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="nasa-svm.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/zsh</span></span>
<span id="cb7-2"><a href="nasa-svm.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> acronym <span class="kw">in</span> US SST IMF VMS RMS DOE NAS LET MLS RCS ISO CM PEM CRM LCC ATM</span>
<span id="cb7-3"><a href="nasa-svm.html#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb7-4"><a href="nasa-svm.html#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="bu">printf</span> <span class="st">&apos;Writing to ./nasa-svm_data/results/output_%s.txt\n&apos;</span> <span class="st">&quot;</span><span class="va">$acronym</span><span class="st">&quot;</span></span>
<span id="cb7-5"><a href="nasa-svm.html#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">5</span><span class="dt">}</span></span>
<span id="cb7-6"><a href="nasa-svm.html#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">do</span></span>
<span id="cb7-7"><a href="nasa-svm.html#cb7-7" aria-hidden="true" tabindex="-1"></a>        <span class="ex">python3</span> nasa_svm.py <span class="va">$acronym</span> <span class="op">&gt;&gt;</span> nasa-svm_data/results/output_<span class="va">${acronym}</span>.csv</span>
<span id="cb7-8"><a href="nasa-svm.html#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">done</span></span>
<span id="cb7-9"><a href="nasa-svm.html#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
<p>Quick analysis using python:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="nasa-svm.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> csv</span>
<span id="cb8-2"><a href="nasa-svm.html#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb8-3"><a href="nasa-svm.html#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> glob</span>
<span id="cb8-4"><a href="nasa-svm.html#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="nasa-svm.html#cb8-5" aria-hidden="true" tabindex="-1"></a>file_list <span class="op">=</span> glob.glob(<span class="st">&quot;nasa-svm_data/results/*.csv&quot;</span>)</span>
<span id="cb8-6"><a href="nasa-svm.html#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="nasa-svm.html#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> file_list:</span>
<span id="cb8-8"><a href="nasa-svm.html#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">with</span> <span class="bu">open</span>(<span class="bu">file</span>, newline<span class="op">=</span><span class="st">&apos;&apos;</span>) <span class="im">as</span> csvfile:</span>
<span id="cb8-9"><a href="nasa-svm.html#cb8-9" aria-hidden="true" tabindex="-1"></a>    buf <span class="op">=</span> pd.DataFrame(csv.reader(csvfile, delimiter<span class="op">=</span><span class="st">&apos; &apos;</span>, quotechar<span class="op">=</span><span class="st">&apos;|&apos;</span>),</span>
<span id="cb8-10"><a href="nasa-svm.html#cb8-10" aria-hidden="true" tabindex="-1"></a>                       columns<span class="op">=</span>[<span class="st">&apos;acronym&apos;</span>, <span class="st">&apos;acc_amb&apos;</span>, <span class="st">&apos;acc_unamb&apos;</span>,<span class="st">&apos;acc_comb&apos;</span>])</span>
<span id="cb8-11"><a href="nasa-svm.html#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">file</span> <span class="op">==</span> file_list[<span class="dv">0</span>]:</span>
<span id="cb8-12"><a href="nasa-svm.html#cb8-12" aria-hidden="true" tabindex="-1"></a>      grades <span class="op">=</span> buf</span>
<span id="cb8-13"><a href="nasa-svm.html#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb8-14"><a href="nasa-svm.html#cb8-14" aria-hidden="true" tabindex="-1"></a>      grades <span class="op">=</span> pd.concat([grades, buf], axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb8-15"><a href="nasa-svm.html#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="nasa-svm.html#cb8-16" aria-hidden="true" tabindex="-1"></a>grades <span class="op">=</span> grades.astype({<span class="st">&apos;acc_amb&apos;</span>:<span class="bu">float</span>, <span class="st">&apos;acc_unamb&apos;</span>:<span class="bu">float</span>, <span class="st">&apos;acc_comb&apos;</span>:<span class="bu">float</span>})</span>
<span id="cb8-17"><a href="nasa-svm.html#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="nasa-svm.html#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Take grouped averages and sort by ambiguous</span></span>
<span id="cb8-19"><a href="nasa-svm.html#cb8-19" aria-hidden="true" tabindex="-1"></a>avgs <span class="op">=</span> grades.groupby([<span class="st">&apos;acronym&apos;</span>])[[<span class="st">&apos;acc_amb&apos;</span>, <span class="st">&apos;acc_unamb&apos;</span>, <span class="st">&apos;acc_comb&apos;</span>]].mean()</span>
<span id="cb8-20"><a href="nasa-svm.html#cb8-20" aria-hidden="true" tabindex="-1"></a>avgs <span class="op">=</span> avgs.sort_values([<span class="st">&apos;acc_amb&apos;</span>], ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb8-21"><a href="nasa-svm.html#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="nasa-svm.html#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Average accuracies (33 randomly sampled test groups)</span></span>
<span id="cb8-23"><a href="nasa-svm.html#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(avgs)</span></code></pre></div>
<pre><code>##           acc_amb  acc_unamb  acc_comb
## acronym                               
## IMF      0.990676   0.904429  0.990676
## MLS      0.982290   0.974813  0.979142
## RCS      0.976874   0.974482  0.990431
## US       0.964912   0.974482  0.998405
## LET      0.964349   0.941176  0.998217
## DOE      0.963020   0.954802  0.955316
## SST      0.939394   0.909091  0.944056
## NAS      0.926815   0.913665  0.923957
## RMS      0.921212   0.943434  0.929293
## LCC      0.746212   0.645833  0.700758
## ISO      0.744444   0.762626  0.795960
## VMS      0.741414   0.888889  0.751515
## PEM      0.609626   0.597148  0.661319
## CM       0.608586   0.624579  0.693603
## CRM      0.582888   0.545455  0.549020
## ATM      0.449811   0.462121  0.482008</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="nasa-svm.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Average accuracies for 2 definitions</span></span>
<span id="cb10-2"><a href="nasa-svm.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(avgs.head(<span class="dv">10</span>)[[<span class="st">&apos;acc_amb&apos;</span>, <span class="st">&apos;acc_unamb&apos;</span>, <span class="st">&apos;acc_comb&apos;</span>]].mean())</span></code></pre></div>
<pre><code>## acc_amb      0.937576
## acc_unamb    0.913621
## acc_comb     0.941025
## dtype: float64</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="nasa-svm.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Average accuracies for 3 definitions (and one 4)</span></span>
<span id="cb12-2"><a href="nasa-svm.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(avgs.tail(<span class="dv">5</span>)[[<span class="st">&apos;acc_amb&apos;</span>, <span class="st">&apos;acc_unamb&apos;</span>, <span class="st">&apos;acc_comb&apos;</span>]].mean())</span></code></pre></div>
<pre><code>## acc_amb      0.598465
## acc_unamb    0.623638
## acc_comb     0.627493
## dtype: float64</code></pre>
</div>
</div>
<div id="conclusions" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Conclusions<a href="nasa-svm.html#conclusions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For 2 definitions this algorithm performs quite well given sparse vocabularies formed from small data.</p>
<p>For more than 2 definitions we run into some problems, the two big ones being sparse vocabularies and <a href="https://machinelearningmastery.com/what-is-imbalanced-classification/">imbalanced class distributions</a>.</p>
<p>There aren&#x2019;t enough instances to properly train the models, but this is out of our hands. Simply, the models need bigger vocabularies to capture the greater complexity presented in acronyms with 3-4 definitions.</p>
<p>Viewing multi-label classification as several related binary classification tasks:</p>
<blockquote>
<p>it&#x2019;s harder to distinguish the remaining 2-3 &#x201C;lesser-known&#x201D; definitions from each other, as opposed to just comparing one other definition to the &#x201C;main/common&#x201D; definition with the highest frequency (therefore making it easily &#x201C;stand out&#x201D;).</p>
</blockquote>
<p>In cases where there is one common definition and 2-3 other lesser-known definitions with sparse data the model is practically blind guessing between comparing pairs of the lesser-known and is only sure when the common is involved.</p>
<div id="todo" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> TODO?<a href="nasa-svm.html#todo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Results could be improved if an <em>unbiased</em> one-vs-all or one-vs-rest (OVA/OVR) classifier is implemented as opposed to the one-vs-one (OVO) used earlier.</p>
<p>For example, with an acronym with 3 definitions:</p>
<ol style="list-style-type: decimal">
<li>There is an approximate class label ratio of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>&#xA0;</mtext><mo>&#x223C;</mo><mn>2</mn><mo>:</mo><mn>1</mn><mo>:</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\ \sim 2:1:1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mspace">&#xA0;</span><span class="mrel">&#x223C;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></li>
<li>Using <code>class_weight=&apos;balanced&apos;</code> in the SVC decreases the weight of records in the &#x201C;common class&#x201D; in order to balance the weight of the whole class
<ul>
<li>Would have to instead perform analysis on distributions in order to manually calculate accurate class weights to pass to the SVC based on label ratios during training</li>
</ul></li>
<li>Perform <a href="https://machinelearningmastery.com/tour-of-evaluation-metrics-for-imbalanced-classification/">comparative metrics</a> for OVO vs OVR given acronyms with 3-4 definitions</li>
</ol>
</div>
</div>
<div id="nasa-fw" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Future Work?<a href="nasa-svm.html#nasa-fw" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are a few hundred other acronyms available to play with. The following examples of acronyms could serve as inspiration for another (more complex) project than this one &#x2013; perhaps for:</p>
<ul>
<li>Learning grammar for either correction or more nuanced guesses (see CFD, TRMM, MSS, TES)</li>
<li>Developing some similarity-based merging of classifications (see AVIRIS, NASA, JPL, CCD)</li>
<li>Maybe even a combo of the aforementioned (see GEO)</li>
</ul>
<p><strong>List of Acronyms - Nuanced Definitions:</strong></p>
<p>Including but not limited to:</p>
<p><code>1. &quot;CFD&quot;: &apos;Computational Fluid Dynamics&apos;, &apos;Computational fluid dynamics&apos;</code></p>
<p><code>2. &quot;TRMM&quot;: &apos;Tropical Rainfall Measuring Mission&apos;, &apos;Tropical Rainfall Measurement Mission&apos;, &apos;Tropical Rain Measuring Mission&apos;</code></p>
<p><code>3. &quot;AVIRIS&quot;: &apos;Airborne Visible/Infrared Imaging Spectrometer&apos;, &apos;Airborne Visible and Infrared Imaging Spectrometer&apos;</code></p>
<p><code>4. &quot;MSS&quot;: &apos;Mobile Satellite Service&apos;, &apos;Mobile Servicing System&apos;</code></p>
<p><code>5. &quot;TES&quot;: &apos;Thermal Emission Spectrometer&apos;, &apos;Tropospheric Emission Spectrometer&apos;</code></p>
<p><code>6. &quot;NASA&quot;: &apos;National Aeronautics &amp; Space Administration&apos;, &apos;National Aeronautic and Space Administration&apos;</code></p>
<p><code>7. &quot;JPL&quot;: &apos;Jet Propulsion Laboratory&apos;, &apos;Jet Propulsion Lab&apos;</code></p>
<p><code>8. &quot;CCD&quot;: &apos;Charge Coupled Device&apos;, &apos;Charge Coupled Devices&apos;</code></p>
<p><code>9. &quot;GEO&quot;: &apos;Geosynchronous Earth Orbit&apos;, &apos;geosynchronous Earth orbit&apos;, &apos;Group on Earth Observations&apos;, &apos;Geostationary Earth Orbit&apos;, &apos;geostationary Earth orbit&apos;</code></p>
<p><strong>Useful Metadata:</strong></p>
<p>Each acronym definition also has &#x201C;NASA terms&#x201D; attached to it, for example IMF comes with some &#x201C;additional context&#x201D; which can be utilized.</p>
<p><code>1. Interplanetary Magnetic Field: &apos;SOLAR MAGNETIC FIELD&apos;, &apos;SOLAR WIND&apos;, &apos;INTERPLANETARY MAGNETIC FIELDS&apos;, &apos;MAGNETIC FLUX&apos;, &apos;MAGNETIC PROBES&apos;, &apos;SPACE PROBES&apos;</code></p>
<p><code>2. Intrinsic Mode Functions: &apos;HILBERT TRANSFORMATION&apos;, &apos;SPECTRAL EMISSION&apos;, &apos;DECOMPOSITION&apos;, &apos;SPECTRUM ANALYSIS&apos;, &apos;TIME FUNCTIONS&apos;, &apos;FREQUENCY DISTRIBUTION&apos;, &apos;NONLINEARITY&apos;, &apos;TIME SERIES ANALYSIS&apos;, &apos;NONLINEAR SYSTEMS&apos;, &apos;NONLINEAR EQUATIONS&apos;</code></p>
</div>
<div id="source-code" class="section level2 unnumbered hasAnchor">
<h2>Source Code<a href="nasa-svm.html#source-code" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The source code for this project can be downloaded or viewed and copied to the clipboard below:</p>
<a href="data:text/x-python;base64,aW1wb3J0IGpzb24KaW1wb3J0IHJlCmltcG9ydCBzdHJpbmcKaW1wb3J0IG5sdGsKaW1wb3J0IHBhbmRhcyBhcyBwZAppbXBvcnQgbnVtcHkgYXMgbnAKZnJvbSBza2xlYXJuLmZlYXR1cmVfZXh0cmFjdGlvbi50ZXh0IGltcG9ydCBUZmlkZlZlY3Rvcml6ZXIsIENvdW50VmVjdG9yaXplcgpmcm9tIHNrbGVhcm4uc3ZtIGltcG9ydCBTVkMKZnJvbSBza2xlYXJuLm11bHRpY2xhc3MgaW1wb3J0IE9uZVZzUmVzdENsYXNzaWZpZXIKaW1wb3J0IHJhbmRvbQpmcm9tIGZ1bmN0b29scyBpbXBvcnQgcmVkdWNlCmltcG9ydCBvcGVyYXRvcgppbXBvcnQgc3lzCiNubHRrLmRvd25sb2FkKCdwdW5rdCcpCiNubHRrLmRvd25sb2FkKCdzdG9wd29yZHMnKQoKZGVmIHByZXByb2Nlc3Moc2VudGVuY2VzLCBzbGljZXMsIG5hbWVzID0gTm9uZSwgdGZpZGYgPSBUcnVlLCBjb250ZXh0ID0gTm9uZSk6CiAgICBpZiBjb250ZXh0IGlzIE5vbmU6IGNvbnRleHQgPSBbXQogICAgZm9yIGkgaW4gcmFuZ2UobGVuKHNsaWNlcykpOgogICAgICAgIGlmIGkgPT0gMDoKICAgICAgICAgICAgY29udGV4dC5hcHBlbmQoJyAnLmpvaW4oc2VudGVuY2VzWzpzbGljZXNbaV1dKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBjb250ZXh0LmFwcGVuZCgnICcuam9pbihzZW50ZW5jZXNbc2xpY2VzW2ktMV06KHNsaWNlc1tpXSArIHNsaWNlc1tpLTFdKV0pKQogICAgY29udGV4dCA9IGNsZWFuZXIoY29udGV4dCkKICAgIGlmIHRmaWRmOgogICAgICAgIGlmIG5hbWVzIGlzIE5vbmU6CiAgICAgICAgICAgIHZlY3RvcnMsIHZvY2FiID0gdGZfaWRmKGNvbnRleHQpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgdmVjdG9ycywgdm9jYWIgPSB0Zl9pZGYoY29udGV4dCwgbmFtZXMpCiAgICAgICAgcmV0dXJuIHZlY3RvcnMsIHZvY2FiCiAgICBlbHNlOgogICAgICAgIHJldHVybiBjb250ZXh0CgpkZWYgY2xlYW5lcihjb250ZXh0KToKICAgIGNvbnRleHQgPSBbcmUuc3ViKHInXHcqXGRcdyonLCAnJywgdykgZm9yIHcgaW4gY29udGV4dF0KICAgIGNvbnRleHQgPSBbcmUuc3ViKHInW15BLVphLXowLTkgXSsnLCAnJywgdykgZm9yIHcgaW4gY29udGV4dF0KICAgIGNvbnRleHQgPSBbcmUuc3ViKHInXHMrJywgJyAnLCB3KSBmb3IgdyBpbiBjb250ZXh0XQogICAgcmV0dXJuIGNvbnRleHQKCmRlZiB0Zl9pZGYoY29udGV4dCwgbmFtZXMgPSBOb25lKToKICAgIHZlY3Rvcml6ZXIgPSBUZmlkZlZlY3Rvcml6ZXIoc3RvcF93b3JkcyA9ICdlbmdsaXNoJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9rZW5fcGF0dGVybiA9IHInKD91KVxiW0EtWmEtel0rXGInKQogICAgdmVjdG9yID0gdmVjdG9yaXplci5maXRfdHJhbnNmb3JtKGNvbnRleHQpCiAgICB2b2NhYiA9IHZlY3Rvcml6ZXIudm9jYWJ1bGFyeV8KICAgIHRva2VucyA9IHZlY3Rvcml6ZXIuZ2V0X2ZlYXR1cmVfbmFtZXNfb3V0KCkKICAgIGRmX3RmaWRmID0gcGQuRGF0YUZyYW1lKGRhdGEgPSB2ZWN0b3IudG9hcnJheSgpLCBpbmRleCA9IG5hbWVzLCBjb2x1bW5zID0gdG9rZW5zKQogICAgcmV0dXJuIGRmX3RmaWRmLCB2b2NhYgoKZGVmIGJvdyhjb250ZXh0LCBuYW1lcyA9IE5vbmUsIHZvY2FiID0gTm9uZSk6CiAgICB2ZWN0b3JpemVyID0gQ291bnRWZWN0b3JpemVyKHN0b3Bfd29yZHMgPSAnZW5nbGlzaCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRva2VuX3BhdHRlcm4gPSByJyg/dSlcYltBLVphLXpdK1xiJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9jYWJ1bGFyeSA9IHZvY2FiKQogICAgdmVjdG9yID0gdmVjdG9yaXplci5maXRfdHJhbnNmb3JtKGNvbnRleHQpCiAgICB0b2tlbnMgPSB2ZWN0b3JpemVyLmdldF9mZWF0dXJlX25hbWVzX291dCgpCiAgICBkZl9ib3cgPSBwZC5EYXRhRnJhbWUoZGF0YSA9IHZlY3Rvci50b2FycmF5KCksIGluZGV4ID0gbmFtZXMsIGNvbHVtbnMgPSB0b2tlbnMpCiAgICByZXR1cm4gZGZfYm93Cgp0b2tlbml6ZXIgPSBubHRrLmRhdGEubG9hZCgndG9rZW5pemVycy9wdW5rdC9lbmdsaXNoLnBpY2tsZScpCmFjcm9ueW1fbGlzdCA9IFsnVVMnLCdTU1QnLCdJTUYnLCdWTVMnLCdSTVMnLCdET0UnLCdOQVMnLCdMRVQnLCdNTFMnLCdSQ1MnLCdJU08nLCdDTScsJ1BFTScsJ0NSTScsJ0xDQycsJ0FUTSddCgp3aXRoIG9wZW4oJ25hc2Etc3ZtX2RhdGEvcHJvY2Vzc2VkL3Byb2Nlc3NlZF9hY3Jvbnltcy5qc29ubCcsICdyJykgYXMganNvbl9hY3Jvbnltcywgb3BlbignbmFzYS1zdm1fZGF0YS9yYXcvcmVzdWx0c19tZXJnZWQuanNvbmwnLCAncicpIGFzIGpzb25fY29ycHVzOgoKICAgIGlmIGxlbihzeXMuYXJndikgPiAxOgogICAgICAgIGFjcm9ueW0gPSBzeXMuYXJndlsxXQogICAgZWxzZToKICAgICAgICBhY3JvbnltID0gcmFuZG9tLmNob2ljZShhY3JvbnltX2xpc3QpCgogICAganNvbl9saXN0ID0gbGlzdChqc29uX2Fjcm9ueW1zKQogICAganNvbl9saXN0X2NvcnB1cyA9IGxpc3QoanNvbl9jb3JwdXMpCiAgICBhbWJpZ3VvdXMsIHNlbnRlbmNlcywgY29tYmluZWQsIG5hbWVzID0gW10sIFtdLCBbXSwgW10KICAgIHNsaWNlcywgc2xpY2VzX2FtYiwgc2xpY2VzX2NtYiwgc2xpY2VzX2FtYl9pbmQgPSBbXSwgW10sIFtdLCBbXQogICAgdGVybXMgPSBbXQogICAgZm9yIGpzb25fc3RyIGluIGpzb25fbGlzdDoKICAgICAgICByZXN1bHQgPSBqc29uLmxvYWRzKGpzb25fc3RyKQogICAgICAgIGlmIHJlc3VsdFsnYWNyb255bSddID09IGFjcm9ueW06CiAgICAgICAgICAgIGtleXdvcmQgPSByZXN1bHRbJ2RlZmluaXRpb24nXSArICIgKCIgKyByZXN1bHRbJ2Fjcm9ueW0nXSArICIpIgogICAgICAgICAgICBrZXl3b3JkMiA9IHJlc3VsdFsnYWNyb255bSddICsgIiAoIiArIHJlc3VsdFsnZGVmaW5pdGlvbiddICsgIikiCiAgICAgICAgICAgIG5hbWVzLmFwcGVuZChyZXN1bHRbJ2RlZmluaXRpb24nXSkKICAgICAgICAgICAgIyBGb3IgYWxsIHRoZSBhYnN0cmFjdHMgd2hlcmUgYWNyb255bSB2YXJpYW50IGlzIGZvdW5kCiAgICAgICAgICAgIGZvciBpIGluIHJhbmdlKGxlbihyZXN1bHRbJ2NvcnB1c19wb3NpdGlvbnMnXSkpOgogICAgICAgICAgICAgICAgaW5kZXggPSByZXN1bHRbJ2NvcnB1c19wb3NpdGlvbnMnXVtpXQogICAgICAgICAgICAgICAganNvbl9hYnN0cmFjdCA9IGpzb25fbGlzdF9jb3JwdXNbaW5kZXhdCiAgICAgICAgICAgICAgICAjIFRha2UgYWJzdHJhY3QsIHNwbGl0IGVhY2ggaW50byBzZW50ZW5jZXMKICAgICAgICAgICAgICAgIGFic3RyYWN0ID0ganNvbi5sb2Fkcyhqc29uX2Fic3RyYWN0KVsnZGVzY3JpcHRpb24nXQogICAgICAgICAgICAgICAgcGFyc2VkID0gdG9rZW5pemVyLnRva2VuaXplKHN0cihhYnN0cmFjdCkpCiAgICAgICAgICAgICAgICAjIEZpbHRlciBzZW50ZW5jZXMgYW5kIGZlZWQgaW50byBzcGxpdCBidWNrZXQKICAgICAgICAgICAgICAgIGZvciBzZW50ZW5jZSBpbiBwYXJzZWQ6CiAgICAgICAgICAgICAgICAgICAgIyBBbGwgb2YgdGhlIHNlbnRlbmNlcwogICAgICAgICAgICAgICAgICAgIGNvbWJpbmVkLmFwcGVuZChzZW50ZW5jZSkKICAgICAgICAgICAgICAgICAgICBjb21iaW5lZFstMV0gPSBjb21iaW5lZFstMV0ucmVwbGFjZShrZXl3b3JkLCAnJykKICAgICAgICAgICAgICAgICAgICBjb21iaW5lZFstMV0gPSBjb21iaW5lZFstMV0ucmVwbGFjZShrZXl3b3JkMiwgJycpCiAgICAgICAgICAgICAgICAgICAgY29tYmluZWRbLTFdID0gY29tYmluZWRbLTFdLnJlcGxhY2UocmVzdWx0WydkZWZpbml0aW9uJ10sICcnKQogICAgICAgICAgICAgICAgICAgIGNvbWJpbmVkWy0xXSA9IGNvbWJpbmVkWy0xXS5yZXBsYWNlKHJlc3VsdFsnYWNyb255bSddLCAnJykKICAgICAgICAgICAgICAgICAgICBpZiBzZW50ZW5jZS5maW5kKGtleXdvcmQpICE9IC0xIG9yIHNlbnRlbmNlLmZpbmQoa2V5d29yZDIpICE9IC0xOgogICAgICAgICAgICAgICAgICAgICAgICBzZW50ZW5jZXMuYXBwZW5kKHNlbnRlbmNlKQogICAgICAgICAgICAgICAgICAgICAgICAjIFJlbW92ZSBhY3JvbnltcyBhbmQgdGhlaXIgZGVmaW5pdGlvbnMKICAgICAgICAgICAgICAgICAgICAgICAgc2VudGVuY2VzWy0xXSA9IHNlbnRlbmNlc1stMV0ucmVwbGFjZShrZXl3b3JkLCAnJykKICAgICAgICAgICAgICAgICAgICAgICAgc2VudGVuY2VzWy0xXSA9IHNlbnRlbmNlc1stMV0ucmVwbGFjZShrZXl3b3JkMiwgJycpCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbnRlbmNlc1stMV0gPSBzZW50ZW5jZXNbLTFdLnJlcGxhY2UocmVzdWx0WydkZWZpbml0aW9uJ10sICcnKQogICAgICAgICAgICAgICAgICAgICAgICAjIENoYW5nZSBpZiBiZWxvdyBiYWNrIHRvIGVsaWYgdG8gaGF2ZSBldmVyeSBzZW50ZW5jZSBjb250YWluaW5nCiAgICAgICAgICAgICAgICAgICAgICAgICMgYm90aCBkZWZpbml0aW9uL2Fjcm9ueW0gcGFpciBBTkQgdW5kZWZpbmVkIGFjcm9ueW1zCiAgICAgICAgICAgICAgICAgICAgICAgICMgY29uc2lkZXJlZCBhcyBvbmx5IHBhcnQgb2YgW3NlbnRlbmNlc10gKE5PVCBhbHNvIGFtYmlndW91cykKICAgICAgICAgICAgICAgICAgICAgICAgIyBhbHNvIGNoYW5nZSBzZW50ZW5jZXNbLTFdIGJhY2sgdG8gc2VudGVuY2UKICAgICAgICAgICAgICAgICAgICAgICAgaWYgc2VudGVuY2UuZmluZChyZXN1bHRbJ2Fjcm9ueW0nXSkgIT0gLTE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbWJpZ3VvdXMuYXBwZW5kKHNlbnRlbmNlc1stMV0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbWJpZ3VvdXNbLTFdID0gYW1iaWd1b3VzWy0xXS5yZXBsYWNlKHJlc3VsdFsnYWNyb255bSddLCAnJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtYmlndW91c1stMV0gPSBhbWJpZ3VvdXNbLTFdLnJlcGxhY2UocmVzdWx0WydkZWZpbml0aW9uJ10sICcnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBBbWJpZ3VvdXMgc2xpY2VzIHcuci50LiBkZWZpbml0aW9ucwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xpY2VzX2FtYl9pbmQuYXBwZW5kKGluZGV4KQogICAgICAgICAgICAgICAgICAgIGVsaWYgc2VudGVuY2UuZmluZChyZXN1bHRbJ2Fjcm9ueW0nXSkgIT0gLTE6CiAgICAgICAgICAgICAgICAgICAgICAgIGFtYmlndW91cy5hcHBlbmQoc2VudGVuY2UpCiAgICAgICAgICAgICAgICAgICAgICAgIGFtYmlndW91c1stMV0gPSBhbWJpZ3VvdXNbLTFdLnJlcGxhY2UocmVzdWx0WydhY3JvbnltJ10sICcnKQogICAgICAgICAgICAgICAgICAgICAgICBhbWJpZ3VvdXNbLTFdID0gYW1iaWd1b3VzWy0xXS5yZXBsYWNlKHJlc3VsdFsnZGVmaW5pdGlvbiddLCAnJykKICAgICAgICAgICAgICAgICAgICAgICAgIyBBbWJpZ3VvdXMgc2xpY2VzIHcuci50LiBkZWZpbml0aW9ucwogICAgICAgICAgICAgICAgICAgICAgICBzbGljZXNfYW1iX2luZC5hcHBlbmQoaW5kZXgpCiAgICAgICAgICAgICMgU2xpY2VzIGJhc2VkIG9uIHdoaWNoIGFjcm9ueW0gc2VudGVuY2UgYmVsb25ncyB0bwogICAgICAgICAgICBpZiBsZW4oc2xpY2VzX2FtYikgPT0gMDoKICAgICAgICAgICAgICAgIHNsaWNlc19hbWIuYXBwZW5kKGxlbihzbGljZXNfYW1iX2luZCkpCiAgICAgICAgICAgICAgICBzbGljZXMuYXBwZW5kKGxlbihzZW50ZW5jZXMpKQogICAgICAgICAgICAgICAgc2xpY2VzX2NtYi5hcHBlbmQobGVuKGNvbWJpbmVkKSkKICAgICAgICAgICAgZWxpZiBsZW4oc2xpY2VzX2FtYikgPT0gMToKICAgICAgICAgICAgICAgIHNsaWNlc19hbWIuYXBwZW5kKGxlbihzbGljZXNfYW1iX2luZCkgLSBzbGljZXNfYW1iWzBdICsgMSkKICAgICAgICAgICAgICAgIHNsaWNlcy5hcHBlbmQobGVuKHNlbnRlbmNlcykgLSBzbGljZXNbMF0gKyAxKQogICAgICAgICAgICAgICAgc2xpY2VzX2NtYi5hcHBlbmQobGVuKGNvbWJpbmVkKSAtIHNsaWNlc19jbWJbMF0gKyAxKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgIyBNb3JlIHRoYW4gMiBkZWZpbnRpaW9ucwogICAgICAgICAgICAgICAgc2xpY2VzX2FtYi5hcHBlbmQobGVuKHNsaWNlc19hbWJfaW5kKSAtIHJlZHVjZShvcGVyYXRvci5hZGQsIHNsaWNlc19hbWIpICsgMSkKICAgICAgICAgICAgICAgIHNsaWNlcy5hcHBlbmQobGVuKHNlbnRlbmNlcykgLSByZWR1Y2Uob3BlcmF0b3IuYWRkLCBzbGljZXMpICsgMSkKICAgICAgICAgICAgICAgIHNsaWNlc19jbWIuYXBwZW5kKGxlbihjb21iaW5lZCkgLSByZWR1Y2Uob3BlcmF0b3IuYWRkLCBzbGljZXNfY21iKSArIDEpCiAgICAgICAgICAgICMgT3B0aW9uYWwgYWRkaXRpb25hbCBjb250ZXh1dGFsIHRlcm1zIGZvciBlYWNoIGRlZmluaXRpb24KICAgICAgICAgICAgI3Rlcm1zLmFwcGVuZCgnICcuam9pbihtYXAoc3RyLCBjbGVhbmVyKGpzb24ubG9hZHMoanNvbl9hYnN0cmFjdClbJ3N1YmplY3QuTkFTQVRlcm1zJ10pKSkpCgogICAgIyBFbnN1cmUgYXQgbGVhc3QgMiBzYW1wbGVzIGZyb20gZWFjaCBkZWZpbml0aW9uIGFyZSBleHRyYWN0ZWQKICAgIGdvb2RfYmF0Y2ggPSBGYWxzZQogICAgd2hpbGUgbm90IGdvb2RfYmF0Y2g6CiAgICAgICAgdGVzdGluZ19zZXQgPSByYW5kb20uc2FtcGxlKGFtYmlndW91cywgcm91bmQobGVuKGFtYmlndW91cykvNSkpCiAgICAgICAgdGVzdGluZ19pbmQsIGtleSA9IFtdLCBbXQogICAgICAgICMgRGV0ZXJtaW5lIHdoaWNoIGFjcm9ueW0gdGhlIHJhbmRvbSBzYW1wbGUgYmVsb25ncyB0bwogICAgICAgIGZvciB0IGluIHRlc3Rpbmdfc2V0OgogICAgICAgICAgICBjb3VudCA9IDAKICAgICAgICAgICAgaWYgYW55KHQgaW4gdGVzdGluZ19zZXQgZm9yIHQgaW4gYW1iaWd1b3VzKToKICAgICAgICAgICAgICAgIHRlc3RpbmdfaW5kLmFwcGVuZChhbWJpZ3VvdXMuaW5kZXgodCkpCiAgICAgICAgICAgICAgICBmb3IgaSBpbiBzbGljZXNfYW1iOgogICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gbGVuKGFtYmlndW91cykgLSBzdW0oc2xpY2VzX2FtYltjb3VudDpdLCAtMSkKICAgICAgICAgICAgICAgICAgICBpZiBhbWJpZ3VvdXMuaW5kZXgodCkgaW4gcmFuZ2Uoc3RhcnQsIGkrc3RhcnQpOgogICAgICAgICAgICAgICAgICAgICAgICBrZXkuYXBwZW5kKG5hbWVzW2NvdW50XSkKICAgICAgICAgICAgICAgICAgICBjb3VudCArPSAxCiAgICAgICAga2V5X2NvdW50cyA9IHtpOmtleS5jb3VudChpKSBmb3IgaSBpbiBuYW1lc30KICAgICAgICBnb29kX2NvdW50ID0ge2s6diBmb3IgKGssdikgaW4ga2V5X2NvdW50cy5pdGVtcygpIGlmIHYgPiAxfQogICAgICAgIGlmIGxlbihrZXlfY291bnRzKSA9PSBsZW4oZ29vZF9jb3VudCk6CiAgICAgICAgICAgIGdvb2RfYmF0Y2ggPSBUcnVlCgogICAgIyBVcGRhdGUgc2xpY2VzCiAgICBrZXlfY291bnRzID0ge2k6a2V5LmNvdW50KGkpIGZvciBpIGluIG5hbWVzfQogICAgc2xpY2VzX2FtYiA9IFthX2kgLSBiX2kgZm9yIGFfaSwgYl9pIGluIHppcChzbGljZXNfYW1iLCBrZXlfY291bnRzLnZhbHVlcygpKV0KICAgIHNsaWNlc19jbWIgPSBbYV9pIC0gYl9pIGZvciBhX2ksIGJfaSBpbiB6aXAoc2xpY2VzX2NtYiwga2V5X2NvdW50cy52YWx1ZXMoKSldCgogICAgIyBSZW1vdmUgc2FtcGxlIGZyb20gdHJhaW5pbmcgc2V0CiAgICBmb3IgdCBpbiB0ZXN0aW5nX3NldDoKICAgICAgICBpZiBhbnkodCBpbiB0ZXN0aW5nX3NldCBmb3IgdCBpbiBhbWJpZ3VvdXMpOgogICAgICAgICAgICBhbWJpZ3VvdXMucmVtb3ZlKHQpCiAgICAgICAgaWYgYW55KHQgaW4gdGVzdGluZ19zZXQgZm9yIHQgaW4gY29tYmluZWQpOgogICAgICAgICAgICBjb21iaW5lZC5yZW1vdmUodCkKCiAgICAjIEJ1aWxkIG1vZGVscwogICAgY29udGV4dCwgdm9jYWIgPSBwcmVwcm9jZXNzKHNlbnRlbmNlcywgc2xpY2VzLCBuYW1lcykKICAgIG1vZGVsID0gU1ZDKEM9MS4sIGtlcm5lbD0nbGluZWFyJywgZGVjaXNpb25fZnVuY3Rpb25fc2hhcGU9J292bycpCiAgICBtb2RlbC5maXQoY29udGV4dCwgbmFtZXMpCgogICAgY29udGV4dF9hbWIsIHZvY2FiX2FtYiA9IHByZXByb2Nlc3MoYW1iaWd1b3VzLCBzbGljZXNfYW1iLCBuYW1lcykKICAgIG1vZGVsX2FtYiA9IFNWQyhDPTEuLCBrZXJuZWw9J2xpbmVhcicsIGRlY2lzaW9uX2Z1bmN0aW9uX3NoYXBlPSdvdm8nKQogICAgbW9kZWxfYW1iLmZpdChjb250ZXh0X2FtYiwgbmFtZXMpCgogICAgY29udGV4dF9jbWIsIHZvY2FiX2NtYiA9IHByZXByb2Nlc3MoY29tYmluZWQsIHNsaWNlc19jbWIsIG5hbWVzKQogICAgbW9kZWxfY21iID0gU1ZDKEM9MS4sIGtlcm5lbD0nbGluZWFyJywgZGVjaXNpb25fZnVuY3Rpb25fc2hhcGU9J292bycpCiAgICBtb2RlbF9jbWIuZml0KGNvbnRleHRfY21iLCBuYW1lcykKCiAgICAjIFByZXBhcmUgdGVzdHMgZm9yIHByZWRpY3Rpb24KICAgIHRlc3Rpbmdfc2V0ID0gY2xlYW5lcih0ZXN0aW5nX3NldCkKICAgIGd1ZXNzLCBndWVzczIsIGd1ZXNzMyA9IFtdLCBbXSwgW10KICAgICMgQmFnIG9mIHdvcmRzIGZvciBhbGwgdGVzdCBzZW50ZW5jZXMKICAgIGRmID0gYm93KHRlc3Rpbmdfc2V0LCB2b2NhYj12b2NhYikKICAgIGRmX2FtYmlnID0gYm93KHRlc3Rpbmdfc2V0LCB2b2NhYj12b2NhYl9hbWIpCiAgICBkZl9jb21iID0gYm93KHRlc3Rpbmdfc2V0LCB2b2NhYj12b2NhYl9jbWIpCgogICAgZm9yIGkgaW4gcmFuZ2UobGVuKHRlc3Rpbmdfc2V0KSk6CiAgICAgICAgZ3Vlc3MuYXBwZW5kKG1vZGVsX2FtYi5wcmVkaWN0KGRmX2FtYmlnLmxvY1tpXS50b19mcmFtZSgpLnRyYW5zcG9zZSgpKSkKICAgICAgICBndWVzczIuYXBwZW5kKG1vZGVsLnByZWRpY3QoZGYubG9jW2ldLnRvX2ZyYW1lKCkudHJhbnNwb3NlKCkpKQogICAgICAgIGd1ZXNzMy5hcHBlbmQobW9kZWxfY21iLnByZWRpY3QoZGZfY29tYi5sb2NbaV0udG9fZnJhbWUoKS50cmFuc3Bvc2UoKSkpCgogICAgcmVzdWx0cyA9IHBkLkRhdGFGcmFtZShbZ3Vlc3MsZ3Vlc3MyLGd1ZXNzMyxrZXldLCBpbmRleD1bJ0d1ZXNzIChhbWJpZ3VvdXMpJywgJ0d1ZXNzICh1bmFtYmlndW91cyknLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0d1ZXNzIChjb21iaW5lZCknLCAnQ29ycmVjdCBBbnN3ZXInXSkKICAgIGdyYWRpbmcgPSBucC53aGVyZShyZXN1bHRzLmxvY1snQ29ycmVjdCBBbnN3ZXInXSA9PSByZXN1bHRzLmxvY1snR3Vlc3MgKGFtYmlndW91cyknXSwgVHJ1ZSwgRmFsc2UpCiAgICBncmFkaW5nMiA9IG5wLndoZXJlKHJlc3VsdHMubG9jWydDb3JyZWN0IEFuc3dlciddID09IHJlc3VsdHMubG9jWydHdWVzcyAodW5hbWJpZ3VvdXMpJ10sIFRydWUsIEZhbHNlKQogICAgZ3JhZGluZzMgPSBucC53aGVyZShyZXN1bHRzLmxvY1snQ29ycmVjdCBBbnN3ZXInXSA9PSByZXN1bHRzLmxvY1snR3Vlc3MgKGNvbWJpbmVkKSddLCBUcnVlLCBGYWxzZSkKCiAgICBpZiBsZW4oc3lzLmFyZ3YpID4gMjoKICAgICAgICBpZiBzeXMuYXJndlsyXSA9PSAnLS12JzoKICAgICAgICAgICAgcHJpbnQoIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0iKQogICAgICAgICAgICBwcmludCgiRXhwYW5zaW9uczpcbiIpCiAgICAgICAgICAgIHByaW50KCdcbicuam9pbihuYW1lcykpCiAgICAgICAgICAgIHByaW50KCJcbkFtYmlndW91cyBuOiIsIGxlbihhbWJpZ3VvdXMpLCAiXHRzbGljZXM6Iiwgc2xpY2VzX2FtYiwKICAgICAgICAgICAgICAgICAgIlxuVW5hbWJpZ3VvdXMgbjoiLCBsZW4oc2VudGVuY2VzKSwgIlx0c2xpY2VzOiIsIHNsaWNlcywKICAgICAgICAgICAgICAgICAgIlxuQ29tYmluZWQgbjoiLCBsZW4oY29tYmluZWQpLCAiXHRzbGljZXM6Iiwgc2xpY2VzX2NtYikKICAgICAgICAgICAgcHJpbnQoIlxuVGVzdCBzZXQ6ICggbiA9IiwgbGVuKHRlc3Rpbmdfc2V0KSwgIikiKQogICAgICAgICAgICBmb3Iga2V5LCB2YWx1ZSBpbiBrZXlfY291bnRzLml0ZW1zKCk6CiAgICAgICAgICAgICAgICBwcmludChrZXksICI6IiwgdmFsdWUpCiAgICAgICAgICAgIHByaW50KCJcbkFjY3VyYWN5IChhbWJpZ3VvdXMpOiAiLCBzdW0oZ3JhZGluZykvbGVuKHRlc3Rpbmdfc2V0KSkKICAgICAgICAgICAgcHJpbnQoIkFjY3VyYWN5ICh1bmFtYmlndW91cyk6ICIsIHN1bShncmFkaW5nMikvbGVuKHRlc3Rpbmdfc2V0KSkKICAgICAgICAgICAgcHJpbnQoIkFjY3VyYWN5IChjb21iaW5lZCk6ICIsIHN1bShncmFkaW5nMykvbGVuKHRlc3Rpbmdfc2V0KSkKICAgIGVsc2U6CiAgICAgICAgcHJpbnQoYWNyb255bSwgc3VtKGdyYWRpbmcpL2xlbih0ZXN0aW5nX3NldCksIHN1bShncmFkaW5nMikvbGVuKHRlc3Rpbmdfc2V0KSwgc3VtKGdyYWRpbmczKS9sZW4odGVzdGluZ19zZXQpKQo=" download="nasa_svm.py">Download nasa_svm.py</a>
<p><br>
</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="nasa-svm.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb14-2"><a href="nasa-svm.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb14-3"><a href="nasa-svm.html#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> string</span>
<span id="cb14-4"><a href="nasa-svm.html#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nltk</span>
<span id="cb14-5"><a href="nasa-svm.html#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb14-6"><a href="nasa-svm.html#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb14-7"><a href="nasa-svm.html#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> TfidfVectorizer, CountVectorizer</span>
<span id="cb14-8"><a href="nasa-svm.html#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb14-9"><a href="nasa-svm.html#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.multiclass <span class="im">import</span> OneVsRestClassifier</span>
<span id="cb14-10"><a href="nasa-svm.html#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb14-11"><a href="nasa-svm.html#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> <span class="bu">reduce</span></span>
<span id="cb14-12"><a href="nasa-svm.html#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> operator</span>
<span id="cb14-13"><a href="nasa-svm.html#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb14-14"><a href="nasa-svm.html#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co">#nltk.download(&apos;punkt&apos;)</span></span>
<span id="cb14-15"><a href="nasa-svm.html#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co">#nltk.download(&apos;stopwords&apos;)</span></span>
<span id="cb14-16"><a href="nasa-svm.html#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="nasa-svm.html#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> preprocess(sentences, slices, names <span class="op">=</span> <span class="va">None</span>, tfidf <span class="op">=</span> <span class="va">True</span>, context <span class="op">=</span> <span class="va">None</span>):</span>
<span id="cb14-18"><a href="nasa-svm.html#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> context <span class="kw">is</span> <span class="va">None</span>: context <span class="op">=</span> []</span>
<span id="cb14-19"><a href="nasa-svm.html#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(slices)):</span>
<span id="cb14-20"><a href="nasa-svm.html#cb14-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb14-21"><a href="nasa-svm.html#cb14-21" aria-hidden="true" tabindex="-1"></a>            context.append(<span class="st">&apos; &apos;</span>.join(sentences[:slices[i]]))</span>
<span id="cb14-22"><a href="nasa-svm.html#cb14-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb14-23"><a href="nasa-svm.html#cb14-23" aria-hidden="true" tabindex="-1"></a>            context.append(<span class="st">&apos; &apos;</span>.join(sentences[slices[i<span class="op">-</span><span class="dv">1</span>]:(slices[i] <span class="op">+</span> slices[i<span class="op">-</span><span class="dv">1</span>])]))</span>
<span id="cb14-24"><a href="nasa-svm.html#cb14-24" aria-hidden="true" tabindex="-1"></a>    context <span class="op">=</span> cleaner(context)</span>
<span id="cb14-25"><a href="nasa-svm.html#cb14-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> tfidf:</span>
<span id="cb14-26"><a href="nasa-svm.html#cb14-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> names <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb14-27"><a href="nasa-svm.html#cb14-27" aria-hidden="true" tabindex="-1"></a>            vectors, vocab <span class="op">=</span> tf_idf(context)</span>
<span id="cb14-28"><a href="nasa-svm.html#cb14-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb14-29"><a href="nasa-svm.html#cb14-29" aria-hidden="true" tabindex="-1"></a>            vectors, vocab <span class="op">=</span> tf_idf(context, names)</span>
<span id="cb14-30"><a href="nasa-svm.html#cb14-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> vectors, vocab</span>
<span id="cb14-31"><a href="nasa-svm.html#cb14-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb14-32"><a href="nasa-svm.html#cb14-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> context</span>
<span id="cb14-33"><a href="nasa-svm.html#cb14-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-34"><a href="nasa-svm.html#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cleaner(context):</span>
<span id="cb14-35"><a href="nasa-svm.html#cb14-35" aria-hidden="true" tabindex="-1"></a>    context <span class="op">=</span> [re.sub(<span class="vs">r&apos;\w*\d\w*&apos;</span>, <span class="st">&apos;&apos;</span>, w) <span class="cf">for</span> w <span class="kw">in</span> context]</span>
<span id="cb14-36"><a href="nasa-svm.html#cb14-36" aria-hidden="true" tabindex="-1"></a>    context <span class="op">=</span> [re.sub(<span class="vs">r&apos;[^A-Za-z0-9 ]+&apos;</span>, <span class="st">&apos;&apos;</span>, w) <span class="cf">for</span> w <span class="kw">in</span> context]</span>
<span id="cb14-37"><a href="nasa-svm.html#cb14-37" aria-hidden="true" tabindex="-1"></a>    context <span class="op">=</span> [re.sub(<span class="vs">r&apos;\s+&apos;</span>, <span class="st">&apos; &apos;</span>, w) <span class="cf">for</span> w <span class="kw">in</span> context]</span>
<span id="cb14-38"><a href="nasa-svm.html#cb14-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> context</span>
<span id="cb14-39"><a href="nasa-svm.html#cb14-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-40"><a href="nasa-svm.html#cb14-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> tf_idf(context, names <span class="op">=</span> <span class="va">None</span>):</span>
<span id="cb14-41"><a href="nasa-svm.html#cb14-41" aria-hidden="true" tabindex="-1"></a>    vectorizer <span class="op">=</span> TfidfVectorizer(stop_words <span class="op">=</span> <span class="st">&apos;english&apos;</span>,</span>
<span id="cb14-42"><a href="nasa-svm.html#cb14-42" aria-hidden="true" tabindex="-1"></a>                                 token_pattern <span class="op">=</span> <span class="vs">r&apos;(?u)\b[A-Za-z]+\b&apos;</span>)</span>
<span id="cb14-43"><a href="nasa-svm.html#cb14-43" aria-hidden="true" tabindex="-1"></a>    vector <span class="op">=</span> vectorizer.fit_transform(context)</span>
<span id="cb14-44"><a href="nasa-svm.html#cb14-44" aria-hidden="true" tabindex="-1"></a>    vocab <span class="op">=</span> vectorizer.vocabulary_</span>
<span id="cb14-45"><a href="nasa-svm.html#cb14-45" aria-hidden="true" tabindex="-1"></a>    tokens <span class="op">=</span> vectorizer.get_feature_names_out()</span>
<span id="cb14-46"><a href="nasa-svm.html#cb14-46" aria-hidden="true" tabindex="-1"></a>    df_tfidf <span class="op">=</span> pd.DataFrame(data <span class="op">=</span> vector.toarray(), index <span class="op">=</span> names, columns <span class="op">=</span> tokens)</span>
<span id="cb14-47"><a href="nasa-svm.html#cb14-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df_tfidf, vocab</span>
<span id="cb14-48"><a href="nasa-svm.html#cb14-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-49"><a href="nasa-svm.html#cb14-49" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> bow(context, names <span class="op">=</span> <span class="va">None</span>, vocab <span class="op">=</span> <span class="va">None</span>):</span>
<span id="cb14-50"><a href="nasa-svm.html#cb14-50" aria-hidden="true" tabindex="-1"></a>    vectorizer <span class="op">=</span> CountVectorizer(stop_words <span class="op">=</span> <span class="st">&apos;english&apos;</span>,</span>
<span id="cb14-51"><a href="nasa-svm.html#cb14-51" aria-hidden="true" tabindex="-1"></a>                                 token_pattern <span class="op">=</span> <span class="vs">r&apos;(?u)\b[A-Za-z]+\b&apos;</span>,</span>
<span id="cb14-52"><a href="nasa-svm.html#cb14-52" aria-hidden="true" tabindex="-1"></a>                                 vocabulary <span class="op">=</span> vocab)</span>
<span id="cb14-53"><a href="nasa-svm.html#cb14-53" aria-hidden="true" tabindex="-1"></a>    vector <span class="op">=</span> vectorizer.fit_transform(context)</span>
<span id="cb14-54"><a href="nasa-svm.html#cb14-54" aria-hidden="true" tabindex="-1"></a>    tokens <span class="op">=</span> vectorizer.get_feature_names_out()</span>
<span id="cb14-55"><a href="nasa-svm.html#cb14-55" aria-hidden="true" tabindex="-1"></a>    df_bow <span class="op">=</span> pd.DataFrame(data <span class="op">=</span> vector.toarray(), index <span class="op">=</span> names, columns <span class="op">=</span> tokens)</span>
<span id="cb14-56"><a href="nasa-svm.html#cb14-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df_bow</span>
<span id="cb14-57"><a href="nasa-svm.html#cb14-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-58"><a href="nasa-svm.html#cb14-58" aria-hidden="true" tabindex="-1"></a>tokenizer <span class="op">=</span> nltk.data.load(<span class="st">&apos;tokenizers/punkt/english.pickle&apos;</span>)</span>
<span id="cb14-59"><a href="nasa-svm.html#cb14-59" aria-hidden="true" tabindex="-1"></a>acronym_list <span class="op">=</span> [<span class="st">&apos;US&apos;</span>,<span class="st">&apos;SST&apos;</span>,<span class="st">&apos;IMF&apos;</span>,<span class="st">&apos;VMS&apos;</span>,<span class="st">&apos;RMS&apos;</span>,<span class="st">&apos;DOE&apos;</span>,<span class="st">&apos;NAS&apos;</span>,<span class="st">&apos;LET&apos;</span>,<span class="st">&apos;MLS&apos;</span>,<span class="st">&apos;RCS&apos;</span>,<span class="st">&apos;ISO&apos;</span>,<span class="st">&apos;CM&apos;</span>,<span class="st">&apos;PEM&apos;</span>,<span class="st">&apos;CRM&apos;</span>,<span class="st">&apos;LCC&apos;</span>,<span class="st">&apos;ATM&apos;</span>]</span>
<span id="cb14-60"><a href="nasa-svm.html#cb14-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-61"><a href="nasa-svm.html#cb14-61" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&apos;nasa-svm_data/processed/processed_acronyms.jsonl&apos;</span>, <span class="st">&apos;r&apos;</span>) <span class="im">as</span> json_acronyms, <span class="bu">open</span>(<span class="st">&apos;nasa-svm_data/raw/results_merged.jsonl&apos;</span>, <span class="st">&apos;r&apos;</span>) <span class="im">as</span> json_corpus:</span>
<span id="cb14-62"><a href="nasa-svm.html#cb14-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-63"><a href="nasa-svm.html#cb14-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(sys.argv) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb14-64"><a href="nasa-svm.html#cb14-64" aria-hidden="true" tabindex="-1"></a>        acronym <span class="op">=</span> sys.argv[<span class="dv">1</span>]</span>
<span id="cb14-65"><a href="nasa-svm.html#cb14-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb14-66"><a href="nasa-svm.html#cb14-66" aria-hidden="true" tabindex="-1"></a>        acronym <span class="op">=</span> random.choice(acronym_list)</span>
<span id="cb14-67"><a href="nasa-svm.html#cb14-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-68"><a href="nasa-svm.html#cb14-68" aria-hidden="true" tabindex="-1"></a>    json_list <span class="op">=</span> <span class="bu">list</span>(json_acronyms)</span>
<span id="cb14-69"><a href="nasa-svm.html#cb14-69" aria-hidden="true" tabindex="-1"></a>    json_list_corpus <span class="op">=</span> <span class="bu">list</span>(json_corpus)</span>
<span id="cb14-70"><a href="nasa-svm.html#cb14-70" aria-hidden="true" tabindex="-1"></a>    ambiguous, sentences, combined, names <span class="op">=</span> [], [], [], []</span>
<span id="cb14-71"><a href="nasa-svm.html#cb14-71" aria-hidden="true" tabindex="-1"></a>    slices, slices_amb, slices_cmb, slices_amb_ind <span class="op">=</span> [], [], [], []</span>
<span id="cb14-72"><a href="nasa-svm.html#cb14-72" aria-hidden="true" tabindex="-1"></a>    terms <span class="op">=</span> []</span>
<span id="cb14-73"><a href="nasa-svm.html#cb14-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> json_str <span class="kw">in</span> json_list:</span>
<span id="cb14-74"><a href="nasa-svm.html#cb14-74" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> json.loads(json_str)</span>
<span id="cb14-75"><a href="nasa-svm.html#cb14-75" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> result[<span class="st">&apos;acronym&apos;</span>] <span class="op">==</span> acronym:</span>
<span id="cb14-76"><a href="nasa-svm.html#cb14-76" aria-hidden="true" tabindex="-1"></a>            keyword <span class="op">=</span> result[<span class="st">&apos;definition&apos;</span>] <span class="op">+</span> <span class="st">&quot; (&quot;</span> <span class="op">+</span> result[<span class="st">&apos;acronym&apos;</span>] <span class="op">+</span> <span class="st">&quot;)&quot;</span></span>
<span id="cb14-77"><a href="nasa-svm.html#cb14-77" aria-hidden="true" tabindex="-1"></a>            keyword2 <span class="op">=</span> result[<span class="st">&apos;acronym&apos;</span>] <span class="op">+</span> <span class="st">&quot; (&quot;</span> <span class="op">+</span> result[<span class="st">&apos;definition&apos;</span>] <span class="op">+</span> <span class="st">&quot;)&quot;</span></span>
<span id="cb14-78"><a href="nasa-svm.html#cb14-78" aria-hidden="true" tabindex="-1"></a>            names.append(result[<span class="st">&apos;definition&apos;</span>])</span>
<span id="cb14-79"><a href="nasa-svm.html#cb14-79" aria-hidden="true" tabindex="-1"></a>            <span class="co"># For all the abstracts where acronym variant is found</span></span>
<span id="cb14-80"><a href="nasa-svm.html#cb14-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(result[<span class="st">&apos;corpus_positions&apos;</span>])):</span>
<span id="cb14-81"><a href="nasa-svm.html#cb14-81" aria-hidden="true" tabindex="-1"></a>                index <span class="op">=</span> result[<span class="st">&apos;corpus_positions&apos;</span>][i]</span>
<span id="cb14-82"><a href="nasa-svm.html#cb14-82" aria-hidden="true" tabindex="-1"></a>                json_abstract <span class="op">=</span> json_list_corpus[index]</span>
<span id="cb14-83"><a href="nasa-svm.html#cb14-83" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Take abstract, split each into sentences</span></span>
<span id="cb14-84"><a href="nasa-svm.html#cb14-84" aria-hidden="true" tabindex="-1"></a>                abstract <span class="op">=</span> json.loads(json_abstract)[<span class="st">&apos;description&apos;</span>]</span>
<span id="cb14-85"><a href="nasa-svm.html#cb14-85" aria-hidden="true" tabindex="-1"></a>                parsed <span class="op">=</span> tokenizer.tokenize(<span class="bu">str</span>(abstract))</span>
<span id="cb14-86"><a href="nasa-svm.html#cb14-86" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Filter sentences and feed into split bucket</span></span>
<span id="cb14-87"><a href="nasa-svm.html#cb14-87" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> sentence <span class="kw">in</span> parsed:</span>
<span id="cb14-88"><a href="nasa-svm.html#cb14-88" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># All of the sentences</span></span>
<span id="cb14-89"><a href="nasa-svm.html#cb14-89" aria-hidden="true" tabindex="-1"></a>                    combined.append(sentence)</span>
<span id="cb14-90"><a href="nasa-svm.html#cb14-90" aria-hidden="true" tabindex="-1"></a>                    combined[<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> combined[<span class="op">-</span><span class="dv">1</span>].replace(keyword, <span class="st">&apos;&apos;</span>)</span>
<span id="cb14-91"><a href="nasa-svm.html#cb14-91" aria-hidden="true" tabindex="-1"></a>                    combined[<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> combined[<span class="op">-</span><span class="dv">1</span>].replace(keyword2, <span class="st">&apos;&apos;</span>)</span>
<span id="cb14-92"><a href="nasa-svm.html#cb14-92" aria-hidden="true" tabindex="-1"></a>                    combined[<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> combined[<span class="op">-</span><span class="dv">1</span>].replace(result[<span class="st">&apos;definition&apos;</span>], <span class="st">&apos;&apos;</span>)</span>
<span id="cb14-93"><a href="nasa-svm.html#cb14-93" aria-hidden="true" tabindex="-1"></a>                    combined[<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> combined[<span class="op">-</span><span class="dv">1</span>].replace(result[<span class="st">&apos;acronym&apos;</span>], <span class="st">&apos;&apos;</span>)</span>
<span id="cb14-94"><a href="nasa-svm.html#cb14-94" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> sentence.find(keyword) <span class="op">!=</span> <span class="op">-</span><span class="dv">1</span> <span class="kw">or</span> sentence.find(keyword2) <span class="op">!=</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb14-95"><a href="nasa-svm.html#cb14-95" aria-hidden="true" tabindex="-1"></a>                        sentences.append(sentence)</span>
<span id="cb14-96"><a href="nasa-svm.html#cb14-96" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># Remove acronyms and their definitions</span></span>
<span id="cb14-97"><a href="nasa-svm.html#cb14-97" aria-hidden="true" tabindex="-1"></a>                        sentences[<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> sentences[<span class="op">-</span><span class="dv">1</span>].replace(keyword, <span class="st">&apos;&apos;</span>)</span>
<span id="cb14-98"><a href="nasa-svm.html#cb14-98" aria-hidden="true" tabindex="-1"></a>                        sentences[<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> sentences[<span class="op">-</span><span class="dv">1</span>].replace(keyword2, <span class="st">&apos;&apos;</span>)</span>
<span id="cb14-99"><a href="nasa-svm.html#cb14-99" aria-hidden="true" tabindex="-1"></a>                        sentences[<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> sentences[<span class="op">-</span><span class="dv">1</span>].replace(result[<span class="st">&apos;definition&apos;</span>], <span class="st">&apos;&apos;</span>)</span>
<span id="cb14-100"><a href="nasa-svm.html#cb14-100" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># Change if below back to elif to have every sentence containing</span></span>
<span id="cb14-101"><a href="nasa-svm.html#cb14-101" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># both definition/acronym pair AND undefined acronyms</span></span>
<span id="cb14-102"><a href="nasa-svm.html#cb14-102" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># considered as only part of [sentences] (NOT also ambiguous)</span></span>
<span id="cb14-103"><a href="nasa-svm.html#cb14-103" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># also change sentences[-1] back to sentence</span></span>
<span id="cb14-104"><a href="nasa-svm.html#cb14-104" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> sentence.find(result[<span class="st">&apos;acronym&apos;</span>]) <span class="op">!=</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb14-105"><a href="nasa-svm.html#cb14-105" aria-hidden="true" tabindex="-1"></a>                            ambiguous.append(sentences[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb14-106"><a href="nasa-svm.html#cb14-106" aria-hidden="true" tabindex="-1"></a>                            ambiguous[<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> ambiguous[<span class="op">-</span><span class="dv">1</span>].replace(result[<span class="st">&apos;acronym&apos;</span>], <span class="st">&apos;&apos;</span>)</span>
<span id="cb14-107"><a href="nasa-svm.html#cb14-107" aria-hidden="true" tabindex="-1"></a>                            ambiguous[<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> ambiguous[<span class="op">-</span><span class="dv">1</span>].replace(result[<span class="st">&apos;definition&apos;</span>], <span class="st">&apos;&apos;</span>)</span>
<span id="cb14-108"><a href="nasa-svm.html#cb14-108" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># Ambiguous slices w.r.t. definitions</span></span>
<span id="cb14-109"><a href="nasa-svm.html#cb14-109" aria-hidden="true" tabindex="-1"></a>                            slices_amb_ind.append(index)</span>
<span id="cb14-110"><a href="nasa-svm.html#cb14-110" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> sentence.find(result[<span class="st">&apos;acronym&apos;</span>]) <span class="op">!=</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb14-111"><a href="nasa-svm.html#cb14-111" aria-hidden="true" tabindex="-1"></a>                        ambiguous.append(sentence)</span>
<span id="cb14-112"><a href="nasa-svm.html#cb14-112" aria-hidden="true" tabindex="-1"></a>                        ambiguous[<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> ambiguous[<span class="op">-</span><span class="dv">1</span>].replace(result[<span class="st">&apos;acronym&apos;</span>], <span class="st">&apos;&apos;</span>)</span>
<span id="cb14-113"><a href="nasa-svm.html#cb14-113" aria-hidden="true" tabindex="-1"></a>                        ambiguous[<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> ambiguous[<span class="op">-</span><span class="dv">1</span>].replace(result[<span class="st">&apos;definition&apos;</span>], <span class="st">&apos;&apos;</span>)</span>
<span id="cb14-114"><a href="nasa-svm.html#cb14-114" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># Ambiguous slices w.r.t. definitions</span></span>
<span id="cb14-115"><a href="nasa-svm.html#cb14-115" aria-hidden="true" tabindex="-1"></a>                        slices_amb_ind.append(index)</span>
<span id="cb14-116"><a href="nasa-svm.html#cb14-116" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Slices based on which acronym sentence belongs to</span></span>
<span id="cb14-117"><a href="nasa-svm.html#cb14-117" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(slices_amb) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb14-118"><a href="nasa-svm.html#cb14-118" aria-hidden="true" tabindex="-1"></a>                slices_amb.append(<span class="bu">len</span>(slices_amb_ind))</span>
<span id="cb14-119"><a href="nasa-svm.html#cb14-119" aria-hidden="true" tabindex="-1"></a>                slices.append(<span class="bu">len</span>(sentences))</span>
<span id="cb14-120"><a href="nasa-svm.html#cb14-120" aria-hidden="true" tabindex="-1"></a>                slices_cmb.append(<span class="bu">len</span>(combined))</span>
<span id="cb14-121"><a href="nasa-svm.html#cb14-121" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">len</span>(slices_amb) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb14-122"><a href="nasa-svm.html#cb14-122" aria-hidden="true" tabindex="-1"></a>                slices_amb.append(<span class="bu">len</span>(slices_amb_ind) <span class="op">-</span> slices_amb[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb14-123"><a href="nasa-svm.html#cb14-123" aria-hidden="true" tabindex="-1"></a>                slices.append(<span class="bu">len</span>(sentences) <span class="op">-</span> slices[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb14-124"><a href="nasa-svm.html#cb14-124" aria-hidden="true" tabindex="-1"></a>                slices_cmb.append(<span class="bu">len</span>(combined) <span class="op">-</span> slices_cmb[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb14-125"><a href="nasa-svm.html#cb14-125" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb14-126"><a href="nasa-svm.html#cb14-126" aria-hidden="true" tabindex="-1"></a>                <span class="co"># More than 2 defintiions</span></span>
<span id="cb14-127"><a href="nasa-svm.html#cb14-127" aria-hidden="true" tabindex="-1"></a>                slices_amb.append(<span class="bu">len</span>(slices_amb_ind) <span class="op">-</span> <span class="bu">reduce</span>(operator.add, slices_amb) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb14-128"><a href="nasa-svm.html#cb14-128" aria-hidden="true" tabindex="-1"></a>                slices.append(<span class="bu">len</span>(sentences) <span class="op">-</span> <span class="bu">reduce</span>(operator.add, slices) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb14-129"><a href="nasa-svm.html#cb14-129" aria-hidden="true" tabindex="-1"></a>                slices_cmb.append(<span class="bu">len</span>(combined) <span class="op">-</span> <span class="bu">reduce</span>(operator.add, slices_cmb) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb14-130"><a href="nasa-svm.html#cb14-130" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Optional additional contexutal terms for each definition</span></span>
<span id="cb14-131"><a href="nasa-svm.html#cb14-131" aria-hidden="true" tabindex="-1"></a>            <span class="co">#terms.append(&apos; &apos;.join(map(str, cleaner(json.loads(json_abstract)[&apos;subject.NASATerms&apos;]))))</span></span>
<span id="cb14-132"><a href="nasa-svm.html#cb14-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-133"><a href="nasa-svm.html#cb14-133" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure at least 2 samples from each definition are extracted</span></span>
<span id="cb14-134"><a href="nasa-svm.html#cb14-134" aria-hidden="true" tabindex="-1"></a>    good_batch <span class="op">=</span> <span class="va">False</span></span>
<span id="cb14-135"><a href="nasa-svm.html#cb14-135" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="kw">not</span> good_batch:</span>
<span id="cb14-136"><a href="nasa-svm.html#cb14-136" aria-hidden="true" tabindex="-1"></a>        testing_set <span class="op">=</span> random.sample(ambiguous, <span class="bu">round</span>(<span class="bu">len</span>(ambiguous)<span class="op">/</span><span class="dv">5</span>))</span>
<span id="cb14-137"><a href="nasa-svm.html#cb14-137" aria-hidden="true" tabindex="-1"></a>        testing_ind, key <span class="op">=</span> [], []</span>
<span id="cb14-138"><a href="nasa-svm.html#cb14-138" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Determine which acronym the random sample belongs to</span></span>
<span id="cb14-139"><a href="nasa-svm.html#cb14-139" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> t <span class="kw">in</span> testing_set:</span>
<span id="cb14-140"><a href="nasa-svm.html#cb14-140" aria-hidden="true" tabindex="-1"></a>            count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb14-141"><a href="nasa-svm.html#cb14-141" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">any</span>(t <span class="kw">in</span> testing_set <span class="cf">for</span> t <span class="kw">in</span> ambiguous):</span>
<span id="cb14-142"><a href="nasa-svm.html#cb14-142" aria-hidden="true" tabindex="-1"></a>                testing_ind.append(ambiguous.index(t))</span>
<span id="cb14-143"><a href="nasa-svm.html#cb14-143" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> i <span class="kw">in</span> slices_amb:</span>
<span id="cb14-144"><a href="nasa-svm.html#cb14-144" aria-hidden="true" tabindex="-1"></a>                    start <span class="op">=</span> <span class="bu">len</span>(ambiguous) <span class="op">-</span> <span class="bu">sum</span>(slices_amb[count:], <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb14-145"><a href="nasa-svm.html#cb14-145" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> ambiguous.index(t) <span class="kw">in</span> <span class="bu">range</span>(start, i<span class="op">+</span>start):</span>
<span id="cb14-146"><a href="nasa-svm.html#cb14-146" aria-hidden="true" tabindex="-1"></a>                        key.append(names[count])</span>
<span id="cb14-147"><a href="nasa-svm.html#cb14-147" aria-hidden="true" tabindex="-1"></a>                    count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb14-148"><a href="nasa-svm.html#cb14-148" aria-hidden="true" tabindex="-1"></a>        key_counts <span class="op">=</span> {i:key.count(i) <span class="cf">for</span> i <span class="kw">in</span> names}</span>
<span id="cb14-149"><a href="nasa-svm.html#cb14-149" aria-hidden="true" tabindex="-1"></a>        good_count <span class="op">=</span> {k:v <span class="cf">for</span> (k,v) <span class="kw">in</span> key_counts.items() <span class="cf">if</span> v <span class="op">&gt;</span> <span class="dv">1</span>}</span>
<span id="cb14-150"><a href="nasa-svm.html#cb14-150" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(key_counts) <span class="op">==</span> <span class="bu">len</span>(good_count):</span>
<span id="cb14-151"><a href="nasa-svm.html#cb14-151" aria-hidden="true" tabindex="-1"></a>            good_batch <span class="op">=</span> <span class="va">True</span></span>
<span id="cb14-152"><a href="nasa-svm.html#cb14-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-153"><a href="nasa-svm.html#cb14-153" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update slices</span></span>
<span id="cb14-154"><a href="nasa-svm.html#cb14-154" aria-hidden="true" tabindex="-1"></a>    key_counts <span class="op">=</span> {i:key.count(i) <span class="cf">for</span> i <span class="kw">in</span> names}</span>
<span id="cb14-155"><a href="nasa-svm.html#cb14-155" aria-hidden="true" tabindex="-1"></a>    slices_amb <span class="op">=</span> [a_i <span class="op">-</span> b_i <span class="cf">for</span> a_i, b_i <span class="kw">in</span> <span class="bu">zip</span>(slices_amb, key_counts.values())]</span>
<span id="cb14-156"><a href="nasa-svm.html#cb14-156" aria-hidden="true" tabindex="-1"></a>    slices_cmb <span class="op">=</span> [a_i <span class="op">-</span> b_i <span class="cf">for</span> a_i, b_i <span class="kw">in</span> <span class="bu">zip</span>(slices_cmb, key_counts.values())]</span>
<span id="cb14-157"><a href="nasa-svm.html#cb14-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-158"><a href="nasa-svm.html#cb14-158" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove sample from training set</span></span>
<span id="cb14-159"><a href="nasa-svm.html#cb14-159" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> testing_set:</span>
<span id="cb14-160"><a href="nasa-svm.html#cb14-160" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">any</span>(t <span class="kw">in</span> testing_set <span class="cf">for</span> t <span class="kw">in</span> ambiguous):</span>
<span id="cb14-161"><a href="nasa-svm.html#cb14-161" aria-hidden="true" tabindex="-1"></a>            ambiguous.remove(t)</span>
<span id="cb14-162"><a href="nasa-svm.html#cb14-162" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">any</span>(t <span class="kw">in</span> testing_set <span class="cf">for</span> t <span class="kw">in</span> combined):</span>
<span id="cb14-163"><a href="nasa-svm.html#cb14-163" aria-hidden="true" tabindex="-1"></a>            combined.remove(t)</span>
<span id="cb14-164"><a href="nasa-svm.html#cb14-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-165"><a href="nasa-svm.html#cb14-165" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Build models</span></span>
<span id="cb14-166"><a href="nasa-svm.html#cb14-166" aria-hidden="true" tabindex="-1"></a>    context, vocab <span class="op">=</span> preprocess(sentences, slices, names)</span>
<span id="cb14-167"><a href="nasa-svm.html#cb14-167" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> SVC(C<span class="op">=</span><span class="fl">1.</span>, kernel<span class="op">=</span><span class="st">&apos;linear&apos;</span>, decision_function_shape<span class="op">=</span><span class="st">&apos;ovo&apos;</span>)</span>
<span id="cb14-168"><a href="nasa-svm.html#cb14-168" aria-hidden="true" tabindex="-1"></a>    model.fit(context, names)</span>
<span id="cb14-169"><a href="nasa-svm.html#cb14-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-170"><a href="nasa-svm.html#cb14-170" aria-hidden="true" tabindex="-1"></a>    context_amb, vocab_amb <span class="op">=</span> preprocess(ambiguous, slices_amb, names)</span>
<span id="cb14-171"><a href="nasa-svm.html#cb14-171" aria-hidden="true" tabindex="-1"></a>    model_amb <span class="op">=</span> SVC(C<span class="op">=</span><span class="fl">1.</span>, kernel<span class="op">=</span><span class="st">&apos;linear&apos;</span>, decision_function_shape<span class="op">=</span><span class="st">&apos;ovo&apos;</span>)</span>
<span id="cb14-172"><a href="nasa-svm.html#cb14-172" aria-hidden="true" tabindex="-1"></a>    model_amb.fit(context_amb, names)</span>
<span id="cb14-173"><a href="nasa-svm.html#cb14-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-174"><a href="nasa-svm.html#cb14-174" aria-hidden="true" tabindex="-1"></a>    context_cmb, vocab_cmb <span class="op">=</span> preprocess(combined, slices_cmb, names)</span>
<span id="cb14-175"><a href="nasa-svm.html#cb14-175" aria-hidden="true" tabindex="-1"></a>    model_cmb <span class="op">=</span> SVC(C<span class="op">=</span><span class="fl">1.</span>, kernel<span class="op">=</span><span class="st">&apos;linear&apos;</span>, decision_function_shape<span class="op">=</span><span class="st">&apos;ovo&apos;</span>)</span>
<span id="cb14-176"><a href="nasa-svm.html#cb14-176" aria-hidden="true" tabindex="-1"></a>    model_cmb.fit(context_cmb, names)</span>
<span id="cb14-177"><a href="nasa-svm.html#cb14-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-178"><a href="nasa-svm.html#cb14-178" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Prepare tests for prediction</span></span>
<span id="cb14-179"><a href="nasa-svm.html#cb14-179" aria-hidden="true" tabindex="-1"></a>    testing_set <span class="op">=</span> cleaner(testing_set)</span>
<span id="cb14-180"><a href="nasa-svm.html#cb14-180" aria-hidden="true" tabindex="-1"></a>    guess, guess2, guess3 <span class="op">=</span> [], [], []</span>
<span id="cb14-181"><a href="nasa-svm.html#cb14-181" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Bag of words for all test sentences</span></span>
<span id="cb14-182"><a href="nasa-svm.html#cb14-182" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> bow(testing_set, vocab<span class="op">=</span>vocab)</span>
<span id="cb14-183"><a href="nasa-svm.html#cb14-183" aria-hidden="true" tabindex="-1"></a>    df_ambig <span class="op">=</span> bow(testing_set, vocab<span class="op">=</span>vocab_amb)</span>
<span id="cb14-184"><a href="nasa-svm.html#cb14-184" aria-hidden="true" tabindex="-1"></a>    df_comb <span class="op">=</span> bow(testing_set, vocab<span class="op">=</span>vocab_cmb)</span>
<span id="cb14-185"><a href="nasa-svm.html#cb14-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-186"><a href="nasa-svm.html#cb14-186" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(testing_set)):</span>
<span id="cb14-187"><a href="nasa-svm.html#cb14-187" aria-hidden="true" tabindex="-1"></a>        guess.append(model_amb.predict(df_ambig.loc[i].to_frame().transpose()))</span>
<span id="cb14-188"><a href="nasa-svm.html#cb14-188" aria-hidden="true" tabindex="-1"></a>        guess2.append(model.predict(df.loc[i].to_frame().transpose()))</span>
<span id="cb14-189"><a href="nasa-svm.html#cb14-189" aria-hidden="true" tabindex="-1"></a>        guess3.append(model_cmb.predict(df_comb.loc[i].to_frame().transpose()))</span>
<span id="cb14-190"><a href="nasa-svm.html#cb14-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-191"><a href="nasa-svm.html#cb14-191" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> pd.DataFrame([guess,guess2,guess3,key], index<span class="op">=</span>[<span class="st">&apos;Guess (ambiguous)&apos;</span>, <span class="st">&apos;Guess (unambiguous)&apos;</span>,</span>
<span id="cb14-192"><a href="nasa-svm.html#cb14-192" aria-hidden="true" tabindex="-1"></a>                                                             <span class="st">&apos;Guess (combined)&apos;</span>, <span class="st">&apos;Correct Answer&apos;</span>])</span>
<span id="cb14-193"><a href="nasa-svm.html#cb14-193" aria-hidden="true" tabindex="-1"></a>    grading <span class="op">=</span> np.where(results.loc[<span class="st">&apos;Correct Answer&apos;</span>] <span class="op">==</span> results.loc[<span class="st">&apos;Guess (ambiguous)&apos;</span>], <span class="va">True</span>, <span class="va">False</span>)</span>
<span id="cb14-194"><a href="nasa-svm.html#cb14-194" aria-hidden="true" tabindex="-1"></a>    grading2 <span class="op">=</span> np.where(results.loc[<span class="st">&apos;Correct Answer&apos;</span>] <span class="op">==</span> results.loc[<span class="st">&apos;Guess (unambiguous)&apos;</span>], <span class="va">True</span>, <span class="va">False</span>)</span>
<span id="cb14-195"><a href="nasa-svm.html#cb14-195" aria-hidden="true" tabindex="-1"></a>    grading3 <span class="op">=</span> np.where(results.loc[<span class="st">&apos;Correct Answer&apos;</span>] <span class="op">==</span> results.loc[<span class="st">&apos;Guess (combined)&apos;</span>], <span class="va">True</span>, <span class="va">False</span>)</span>
<span id="cb14-196"><a href="nasa-svm.html#cb14-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-197"><a href="nasa-svm.html#cb14-197" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(sys.argv) <span class="op">&gt;</span> <span class="dv">2</span>:</span>
<span id="cb14-198"><a href="nasa-svm.html#cb14-198" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> sys.argv[<span class="dv">2</span>] <span class="op">==</span> <span class="st">&apos;--v&apos;</span>:</span>
<span id="cb14-199"><a href="nasa-svm.html#cb14-199" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;-------------------------&quot;</span>)</span>
<span id="cb14-200"><a href="nasa-svm.html#cb14-200" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;Expansions:</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb14-201"><a href="nasa-svm.html#cb14-201" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&apos;</span><span class="ch">\n</span><span class="st">&apos;</span>.join(names))</span>
<span id="cb14-202"><a href="nasa-svm.html#cb14-202" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Ambiguous n:&quot;</span>, <span class="bu">len</span>(ambiguous), <span class="st">&quot;</span><span class="ch">\t</span><span class="st">slices:&quot;</span>, slices_amb,</span>
<span id="cb14-203"><a href="nasa-svm.html#cb14-203" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Unambiguous n:&quot;</span>, <span class="bu">len</span>(sentences), <span class="st">&quot;</span><span class="ch">\t</span><span class="st">slices:&quot;</span>, slices,</span>
<span id="cb14-204"><a href="nasa-svm.html#cb14-204" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Combined n:&quot;</span>, <span class="bu">len</span>(combined), <span class="st">&quot;</span><span class="ch">\t</span><span class="st">slices:&quot;</span>, slices_cmb)</span>
<span id="cb14-205"><a href="nasa-svm.html#cb14-205" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Test set: ( n =&quot;</span>, <span class="bu">len</span>(testing_set), <span class="st">&quot;)&quot;</span>)</span>
<span id="cb14-206"><a href="nasa-svm.html#cb14-206" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> key, value <span class="kw">in</span> key_counts.items():</span>
<span id="cb14-207"><a href="nasa-svm.html#cb14-207" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(key, <span class="st">&quot;:&quot;</span>, value)</span>
<span id="cb14-208"><a href="nasa-svm.html#cb14-208" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Accuracy (ambiguous): &quot;</span>, <span class="bu">sum</span>(grading)<span class="op">/</span><span class="bu">len</span>(testing_set))</span>
<span id="cb14-209"><a href="nasa-svm.html#cb14-209" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;Accuracy (unambiguous): &quot;</span>, <span class="bu">sum</span>(grading2)<span class="op">/</span><span class="bu">len</span>(testing_set))</span>
<span id="cb14-210"><a href="nasa-svm.html#cb14-210" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;Accuracy (combined): &quot;</span>, <span class="bu">sum</span>(grading3)<span class="op">/</span><span class="bu">len</span>(testing_set))</span>
<span id="cb14-211"><a href="nasa-svm.html#cb14-211" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb14-212"><a href="nasa-svm.html#cb14-212" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(acronym, <span class="bu">sum</span>(grading)<span class="op">/</span><span class="bu">len</span>(testing_set), <span class="bu">sum</span>(grading2)<span class="op">/</span><span class="bu">len</span>(testing_set), <span class="bu">sum</span>(grading3)<span class="op">/</span><span class="bu">len</span>(testing_set))</span></code></pre></div>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Turtel2007AcronymD" class="csl-entry">
Turtel, Benjamin D., and Dennis Shasha. 2007. <span>&#x201C;Acronym Disambiguation.&#x201D;</span> In. <a href="https://cs.nyu.edu/media/publications/TR2015-973.pdf">https://cs.nyu.edu/media/publications/TR2015-973.pdf</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="google-capstone.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
